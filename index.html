<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TheHardwareHotline.com — Book Appointments</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  :root{
    --orange:#E87042;
    --orange-hover:#ff7a3f;
    --bg:#0f0f10;
    --card:#1f2937;
    --success:#16a34a;
    --danger:#b91c1c;
  }
  body { background: var(--bg); color: #e6e6e6; font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
  .btn-orange { background: var(--orange); color: white; }
  .btn-orange:hover { background: var(--orange-hover); }
  .card { background: var(--card); }
  .dot { display:inline-block; width:10px; height:10px; border-radius:999px; margin-right:8px; vertical-align:middle; }
</style>
</head>
<body class="min-h-screen">

<header class="sticky top-0 z-30 bg-black/60 backdrop-blur border-b border-orange-700">
  <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
    <div class="flex items-center space-x-4">
      <div class="text-2xl font-extrabold text-orange-400">TheHardwareHotline.com</div>
      <div class="text-sm text-gray-400">30 Years Experience</div>
    </div>
    <div class="flex items-center space-x-3">
      <button id="bookBtn" class="px-4 py-2 rounded-lg btn-orange font-semibold shadow" onclick="scrollToBooking()">Book Appointment</button>
      <button id="adminBtn" class="px-4 py-2 rounded-lg btn-orange font-semibold shadow" onclick="promptAdminKey()">View Appointments</button>
      <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=blackicerocks82@gmail.com&item_name=Support%20TheHardwareHotline.com"
         target="_blank"
         class="px-4 py-2 rounded-lg bg-gray-800 border border-orange-700 text-orange-300 font-semibold hover:bg-gray-700 transition">Donate</a>
    </div>
  </div>
</header>

<section class="py-16">
  <div class="max-w-6xl mx-auto px-4 grid md:grid-cols-2 gap-10 items-center">
    <div>
      <h1 class="text-4xl md:text-5xl font-extrabold text-orange-400 leading-tight">Professional Computer Repair <span class="text-white">— For the love of the game</span></h1>
      <p class="mt-4 text-gray-300 text-lg">30 years of hands-on experience repairing, optimizing, and building PCs. Free diagnostics and labor — you only pay for parts if needed. Book a free drop-off appointment below.</p>
    </div>

    <div class="card p-6 rounded-xl shadow-lg">
      <h3 class="text-xl font-bold text-orange-300 mb-4">Quick info</h3>
      <p class="text-gray-300">Drop-off appointment windows are one hour. Times shown as local. We try to respond quickly — thank you for trusting TheHardwareHotline.</p>
    </div>
  </div>
</section>

<main class="max-w-5xl mx-auto px-4 pb-20">

<section id="bookingCard" class="card p-6 rounded-2xl shadow-xl">
  <h2 class="text-2xl font-extrabold text-orange-300 mb-3">Schedule a Drop-Off Appointment</h2>
  <form id="bookingForm" class="space-y-4">
    <div>
      <label class="block text-sm text-gray-300 mb-1" for="name">Your Name</label>
      <input id="name" name="name" required type="text" placeholder="e.g., John" class="w-full p-3 rounded bg-gray-800 border border-gray-700 focus:border-orange-500" />
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm text-gray-300 mb-1" for="date">Preferred Date</label>
        <input id="date" name="date" required type="date" class="w-full p-3 rounded bg-gray-800 border border-gray-700 focus:border-orange-500" />
      </div>
      <div>
        <label class="block text-sm text-gray-300 mb-1" for="time">Preferred Time</label>
        <select id="time" name="time" required class="w-full p-3 rounded bg-gray-800 border border-gray-700 focus:border-orange-500">
          <option value="">Select a date first</option>
        </select>
      </div>
    </div>
    <div>
      <label class="block text-sm text-gray-300 mb-1" for="description">Brief Description</label>
      <textarea id="description" name="description" rows="3" required placeholder="e.g., 'PC won't boot'" class="w-full p-3 rounded bg-gray-800 border border-gray-700 focus:border-orange-500"></textarea>
    </div>
    <div class="flex flex-col sm:flex-row gap-3">
      <button id="submitBtn" class="btn-orange px-5 py-3 rounded-lg font-semibold shadow">Save Appointment Request</button>
    </div>
    <p id="formFeedback" class="mt-3 text-center text-sm"></p>
  </form>
</section>

<section class="mt-6">
  <div class="card p-4 rounded-xl shadow-inner">
    <h3 class="text-lg font-bold text-orange-300 mb-3">Upcoming Appointments</h3>
    <div id="compactAppointments" class="max-h-48 overflow-y-auto divide-y divide-gray-700 p-1">
      <p class="text-gray-400">Loading appointments…</p>
    </div>
  </div>
</section>

<!-- THANK YOU MODAL -->
<div id="thankModal" class="fixed inset-0 flex items-center justify-center bg-black/60 hidden z-50">
  <div class="bg-card p-6 rounded-xl max-w-md w-full text-center">
    <h4 class="text-2xl font-bold text-orange-300 mb-3">Thanks — Appointment Booked!</h4>
    <button class="btn-orange px-4 py-2 rounded" onclick="closeThankModal()">Close</button>
  </div>
</div>

<footer class="mt-12 py-8 border-t border-gray-800 text-center text-sm text-gray-400">
  &copy; <span id="year"></span> TheHardwareHotline.com
</footer>

<script>
const SHEET_API = "https://script.google.com/macros/s/AKfycbwz1iUFnyUersgFiuMGCUnCP0STeMsEzI34QHJbQZFARU4IIXRWs6Bqn-FCsCzPmjkPJA/exec";
const DAILY_SLOTS = ["09:00 AM - 10:00 AM","10:00 AM - 11:00 AM","11:00 AM - 12:00 PM","12:00 PM - 01:00 PM","01:00 PM - 02:00 PM","02:00 PM - 03:00 PM","03:00 PM - 04:00 PM","04:00 PM - 05:00 PM"];
let appointments = [];

const dateInput = document.getElementById('date');
const timeSelect = document.getElementById('time');
const bookingForm = document.getElementById('bookingForm');
const formFeedback = document.getElementById('formFeedback');
const compactAppointments = document.getElementById('compactAppointments');
const thankModal = document.getElementById('thankModal');
const yearSpan = document.getElementById('year');

yearSpan.textContent = new Date().getFullYear();
dateInput.min = new Date(new Date().setDate(new Date().getDate()+1)).toISOString().split('T')[0];

function prettyDate(d){ const dt = new Date(d); return isNaN(dt)? d : dt.toLocaleDateString(); }

async function fetchAppointments(){
  try{
    const res = await fetch(SHEET_API);
    appointments = await res.json();
    renderCompactAppointments();
    updateTimeSlots();
  }catch(err){
    console.error(err);
    compactAppointments.innerHTML = '<p class="text-red-500">Could not load appointments.</p>';
  }
}

function renderCompactAppointments(){
  if(!appointments.length){ compactAppointments.innerHTML='<p class="text-gray-400">No appointments yet — be the first!</p>'; return; }
  const sorted = appointments.slice().sort((a,b)=> a.date===b.date ? a.time.localeCompare(b.time) : a.date.localeCompare(b.date));
  compactAppointments.innerHTML='';
  sorted.forEach(a=>{
    const el = document.createElement('div');
    el.className='py-2';
    el.innerHTML=`<div><div class="text-sm font-semibold text-orange-300">${a.name||'Client'}</div><div class="text-xs text-gray-300">${prettyDate(a.date)} • ${a.time}</div><div class="text-gray-300 mt-1 text-sm">${a.description||''}</div></div>`;
    compactAppointments.appendChild(el);
  });
}

function updateTimeSlots(){
  const selectedDate = dateInput.value;
  timeSelect.innerHTML='<option value="">Select a time</option>';
  if(!selectedDate) return;
  const booked = appointments.filter(a=>a.date===selectedDate).map(a=>a.time);
  DAILY_SLOTS.forEach(slot=>{
    const opt=document.createElement('option');
    opt.value=slot;
    opt.textContent = booked.includes(slot) ? `${slot} (BOOKED)` : `${slot} (Available)`;
    opt.disabled = booked.includes(slot);
    timeSelect.appendChild(opt);
  });
}

bookingForm.addEventListener('submit', async e=>{
  e.preventDefault();
  formFeedback.textContent='';
  const name=document.getElementById('name').value.trim();
  const date=dateInput.value;
  const time=timeSelect.value;
  const description=document.getElementById('description').value.trim();
  if(!name||!date||!time||!description){ formFeedback.textContent="Please fill out all fields."; formFeedback.style.color="tomato"; return;}
  if(appointments.some(a=>a.date===date&&a.time===time)){ formFeedback.textContent="Sorry — that slot was just booked."; formFeedback.style.color="tomato"; updateTimeSlots(); return;}
  try{
    const res=await fetch(SHEET_API,{method:'POST',headers:{"Content-Type":"application/json"},body:JSON.stringify({name,date,time,description})});
    const json=await res.json();
    if(json.status==='success'){ formFeedback.textContent="Appointment booked!"; formFeedback.style.color="lightgreen"; bookingForm.reset(); setTimeout(()=>thankModal.classList.remove('hidden'),300); await fetchAppointments(); }
    else{ formFeedback.textContent="Error saving appointment."; formFeedback.style.color="tomato"; console.error(json); }
  }catch(err){ console.error(err); formFeedback.textContent="Network error — could not book appointment."; formFeedback.style.color="tomato"; }
});

function closeThankModal(){ thankModal.classList.add('hidden'); }
function scrollToBooking(){ document.getElementById('bookingCard').scrollIntoView({behavior:'smooth'}); }

fetchAppointments();
</script>
</body>
</html>


